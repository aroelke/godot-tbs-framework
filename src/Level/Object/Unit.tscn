[gd_scene load_steps=16 format=3 uid="uid://b0cvutx2lj5uy"]

[ext_resource type="Script" path="res://src/Level/Object/Unit.cs" id="1_crlbh"]
[ext_resource type="Texture2D" uid="uid://3oc7r54iby4a" path="res://assets/level/unit/soldier.png" id="2_ipnjg"]
[ext_resource type="Script" path="res://src/Object/BoundedNode2D.cs" id="3_pmja0"]
[ext_resource type="Script" path="res://addons/godot_state_charts/state_chart.gd" id="4_6bp8w"]
[ext_resource type="Script" path="res://addons/godot_state_charts/compound_state.gd" id="5_0muba"]
[ext_resource type="Script" path="res://addons/godot_state_charts/animation_player_state.gd" id="6_suod6"]
[ext_resource type="Script" path="res://addons/godot_state_charts/transition.gd" id="7_g4o4f"]

[sub_resource type="Animation" id="Animation_yixnx"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Path/PathFollow/Sprite:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [Vector2i(0, 1)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Path/PathFollow/Sprite:flip_h")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}

[sub_resource type="Animation" id="Animation_kehkl"]
resource_name = "down"
length = 0.8
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Path/PathFollow/Sprite:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.2, 0.4, 0.6),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [Vector2i(2, 0), Vector2i(2, 1), Vector2i(2, 2), Vector2i(2, 3)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Path/PathFollow/Sprite:flip_h")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}

[sub_resource type="Animation" id="Animation_dpr7d"]
resource_name = "idle"
length = 0.8
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Path/PathFollow/Sprite:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.2, 0.4, 0.6),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [Vector2i(0, 1), Vector2i(0, 2), Vector2i(0, 3), Vector2i(0, 2)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Path/PathFollow/Sprite:flip_h")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}

[sub_resource type="Animation" id="Animation_c8tpx"]
resource_name = "left"
length = 0.8
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Path/PathFollow/Sprite:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.2, 0.4, 0.6),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [Vector2i(1, 0), Vector2i(1, 1), Vector2i(1, 2), Vector2i(1, 3)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Path/PathFollow/Sprite:flip_h")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}

[sub_resource type="Animation" id="Animation_48wh4"]
resource_name = "right"
length = 0.8
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Path/PathFollow/Sprite:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.2, 0.4, 0.6),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [Vector2i(1, 0), Vector2i(1, 1), Vector2i(1, 2), Vector2i(1, 3)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Path/PathFollow/Sprite:flip_h")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [true]
}

[sub_resource type="Animation" id="Animation_p0gt1"]
resource_name = "selected"
length = 0.8
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Path/PathFollow/Sprite:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.2, 0.4, 0.6),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [Vector2i(4, 1), Vector2i(4, 2), Vector2i(4, 3), Vector2i(4, 2)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Path/PathFollow/Sprite:flip_h")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}

[sub_resource type="Animation" id="Animation_kk35a"]
resource_name = "up"
length = 0.8
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Path/PathFollow/Sprite:frame_coords")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.2, 0.4, 0.6),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [Vector2i(3, 0), Vector2i(3, 1), Vector2i(3, 2), Vector2i(3, 3)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Path/PathFollow/Sprite:flip_h")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_txw1y"]
_data = {
"RESET": SubResource("Animation_yixnx"),
"down": SubResource("Animation_kehkl"),
"idle": SubResource("Animation_dpr7d"),
"left": SubResource("Animation_c8tpx"),
"right": SubResource("Animation_48wh4"),
"selected": SubResource("Animation_p0gt1"),
"up": SubResource("Animation_kk35a")
}

[node name="Unit" type="Node2D"]
script = ExtResource("1_crlbh")

[node name="Path" type="Path2D" parent="."]

[node name="PathFollow" type="PathFollow2D" parent="Path"]
rotates = false
cubic_interp = false
loop = false

[node name="Sprite" type="Sprite2D" parent="Path/PathFollow"]
texture = ExtResource("2_ipnjg")
offset = Vector2(16, 0)
hframes = 5
vframes = 4
frame = 5

[node name="Bounds" type="Node2D" parent="Path/PathFollow"]
script = ExtResource("3_pmja0")

[node name="Animation" type="AnimationPlayer" parent="."]
libraries = {
"": SubResource("AnimationLibrary_txw1y")
}
autoplay = "idle"

[node name="State" type="Node" parent="."]
script = ExtResource("4_6bp8w")

[node name="Root" type="Node" parent="State"]
script = ExtResource("5_0muba")
initial_state = NodePath("Idle")

[node name="Idle" type="Node" parent="State/Root"]
script = ExtResource("6_suod6")
animation_player = NodePath("../../../Animation")
animation_name = &"idle"

[node name="ToSelected" type="Node" parent="State/Root/Idle"]
script = ExtResource("7_g4o4f")
to = NodePath("../../Selected")
event = &"select"

[node name="ToDone" type="Node" parent="State/Root/Idle"]
script = ExtResource("7_g4o4f")
to = NodePath("../../Done")
event = &"wait"

[node name="Selected" type="Node" parent="State/Root"]
script = ExtResource("6_suod6")
animation_player = NodePath("../../../Animation")
animation_name = &"selected"

[node name="ToIdle" type="Node" parent="State/Root/Selected"]
script = ExtResource("7_g4o4f")
to = NodePath("../../Idle")
event = &"deselect"

[node name="ToMoving" type="Node" parent="State/Root/Selected"]
script = ExtResource("7_g4o4f")
to = NodePath("../../Moving")
event = &"move"

[node name="ToDone" type="Node" parent="State/Root/Selected"]
script = ExtResource("7_g4o4f")
to = NodePath("../../Done")
event = &"wait"

[node name="Moving" type="Node" parent="State/Root"]
script = ExtResource("5_0muba")
initial_state = NodePath("Down")

[node name="Down" type="Node" parent="State/Root/Moving"]
script = ExtResource("6_suod6")
animation_player = NodePath("../../../../Animation")
animation_name = &"down"

[node name="ToLeft" type="Node" parent="State/Root/Moving/Down"]
script = ExtResource("7_g4o4f")
to = NodePath("../../Left")
event = &"left"

[node name="ToRight" type="Node" parent="State/Root/Moving/Down"]
script = ExtResource("7_g4o4f")
to = NodePath("../../Right")
event = &"right"

[node name="ToUp" type="Node" parent="State/Root/Moving/Down"]
script = ExtResource("7_g4o4f")
to = NodePath("../../Up")
event = &"up"

[node name="Left" type="Node" parent="State/Root/Moving"]
script = ExtResource("6_suod6")
animation_player = NodePath("../../../../Animation")
animation_name = &"left"

[node name="ToRight" type="Node" parent="State/Root/Moving/Left"]
script = ExtResource("7_g4o4f")
to = NodePath("../../Right")
event = &"right"

[node name="ToUp" type="Node" parent="State/Root/Moving/Left"]
script = ExtResource("7_g4o4f")
to = NodePath("../../Up")
event = &"up"

[node name="ToDown" type="Node" parent="State/Root/Moving/Left"]
script = ExtResource("7_g4o4f")
to = NodePath("../../Down")
event = &"down"

[node name="Right" type="Node" parent="State/Root/Moving"]
script = ExtResource("6_suod6")
animation_player = NodePath("../../../../Animation")
animation_name = &"right"

[node name="ToLeft" type="Node" parent="State/Root/Moving/Right"]
script = ExtResource("7_g4o4f")
to = NodePath("../../Left")
event = &"left"

[node name="ToUp" type="Node" parent="State/Root/Moving/Right"]
script = ExtResource("7_g4o4f")
to = NodePath("../../Up")
event = &"up"

[node name="ToDown" type="Node" parent="State/Root/Moving/Right"]
script = ExtResource("7_g4o4f")
to = NodePath("../../Down")
event = &"down"

[node name="Up" type="Node" parent="State/Root/Moving"]
script = ExtResource("6_suod6")
animation_player = NodePath("../../../../Animation")
animation_name = &"up"

[node name="ToLeft" type="Node" parent="State/Root/Moving/Up"]
script = ExtResource("7_g4o4f")
to = NodePath("../../Left")
event = &"left"

[node name="ToRight" type="Node" parent="State/Root/Moving/Up"]
script = ExtResource("7_g4o4f")
to = NodePath("../../Right")
event = &"right"

[node name="ToDown" type="Node" parent="State/Root/Moving/Up"]
script = ExtResource("7_g4o4f")
to = NodePath("../../Down")
event = &"down"

[node name="ToSelected" type="Node" parent="State/Root/Moving"]
script = ExtResource("7_g4o4f")
to = NodePath("../../Selected")
event = &"stop"

[node name="Done" type="Node" parent="State/Root"]
script = ExtResource("6_suod6")
animation_player = NodePath("../../../Animation")
animation_name = &"RESET"

[connection signal="child_state_entered" from="State/Root/Moving" to="." method="OnMovingEntered"]
[connection signal="child_state_exited" from="State/Root/Moving" to="." method="OnMovingExited"]
